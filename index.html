<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="ADD Companion">
  <meta name="theme-color" content="#1f2937">
  <title>ADD Companion</title>
  
  <link rel="manifest" href="data:application/json,{&quot;name&quot;:&quot;ADD Companion&quot;,&quot;short_name&quot;:&quot;ADD&quot;,&quot;start_url&quot;:&quot;.&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;background_color&quot;:&quot;%23f9fafb&quot;,&quot;theme_color&quot;:&quot;%231f2937&quot;}">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f9fafb;
      min-height: 100vh;
      min-height: 100dvh;
      color: #1f2937;
      line-height: 1.5;
    }
    
    .container { max-width: 500px; margin: 0 auto; padding-bottom: 2rem; }
    
    /* Header */
    .header {
      position: sticky;
      top: 0;
      background: white;
      border-bottom: 1px solid #e5e7eb;
      z-index: 10;
    }
    
    .header-inner {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem 1.25rem;
    }
    
    .back-btn {
      background: none;
      border: none;
      padding: 0.5rem;
      margin-left: -0.5rem;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .back-btn:active { background: #f3f4f6; }
    .back-btn svg { width: 1.25rem; height: 1.25rem; color: #374151; }
    
    .header-title { font-weight: 600; font-size: 1.1rem; }
    
    /* Home View */
    .home-header { padding: 1.5rem 1.25rem 0.75rem; }
    .home-header h1 { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.25rem; }
    .home-header p { color: #6b7280; font-size: 0.875rem; }
    
    /* Main Options */
    .main-options {
      padding: 0.5rem 1.25rem 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .option-card {
      width: 100%;
      padding: 1.25rem;
      border-radius: 1rem;
      border: 2px solid;
      text-align: left;
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.2s;
      background: white;
    }
    
    .option-card:active { transform: scale(0.98); }
    
    .option-card-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.375rem;
    }
    
    .option-icon {
      width: 2.75rem;
      height: 2.75rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .option-icon svg { width: 1.375rem; height: 1.375rem; color: white; }
    .option-label { font-weight: 600; font-size: 1.05rem; }
    .option-desc { font-size: 0.875rem; color: #6b7280; margin-left: 3.5rem; }
    
    /* Option Colors */
    .option-checkin { background: #f0fdf4; border-color: #86efac; }
    .option-checkin .option-icon { background: #22c55e; }
    .option-checkin .option-label { color: #166534; }
    
    .option-understand { background: #eff6ff; border-color: #93c5fd; }
    .option-understand .option-icon { background: #3b82f6; }
    .option-understand .option-label { color: #1e40af; }
    
    /* State Cards */
    .states-header { padding: 1.25rem 1.25rem 0.75rem; font-size: 1.1rem; font-weight: 600; }
    
    .states-grid {
      padding: 0 1.25rem;
      display: flex;
      flex-direction: column;
      gap: 0.625rem;
    }
    
    .state-card {
      width: 100%;
      padding: 1rem;
      border-radius: 1rem;
      border: 2px solid;
      text-align: left;
      cursor: pointer;
      transition: transform 0.1s;
      background: white;
    }
    
    .state-card:active { transform: scale(0.98); }
    
    .state-card-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .state-icon {
      width: 2.25rem;
      height: 2.25rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .state-icon svg { width: 1.125rem; height: 1.125rem; color: white; }
    .state-label { font-weight: 600; font-size: 0.95rem; }
    .state-desc { font-size: 0.8rem; color: #6b7280; margin-left: 3rem; margin-top: 0.25rem; }
    
    /* State Colors */
    .state-understimulated .state-card { background: #fffbeb; border-color: #fde68a; }
    .state-understimulated .state-icon { background: #f59e0b; }
    .state-understimulated .state-label { color: #b45309; }
    
    .state-overwhelmed .state-card { background: #f8fafc; border-color: #cbd5e1; }
    .state-overwhelmed .state-icon { background: #64748b; }
    .state-overwhelmed .state-label { color: #475569; }
    
    .state-hyperactivated .state-card { background: #fff1f2; border-color: #fecdd3; }
    .state-hyperactivated .state-icon { background: #f43f5e; }
    .state-hyperactivated .state-label { color: #be123c; }
    
    .state-regulated .state-card { background: #ecfdf5; border-color: #a7f3d0; }
    .state-regulated .state-icon { background: #10b981; }
    .state-regulated .state-label { color: #047857; }
    
    /* Sections Grid */
    .sections-header { padding: 1.5rem 1.25rem 0.75rem; font-size: 1.1rem; font-weight: 600; }
    
    .sections-grid {
      padding: 0 1.25rem;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
    }
    
    .section-btn {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 0.75rem;
      cursor: pointer;
      text-align: left;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    
    .section-btn:active { background: #f9fafb; }
    .section-btn svg { width: 1.25rem; height: 1.25rem; color: #9ca3af; flex-shrink: 0; }
    .section-btn span { font-weight: 500; color: #374151; font-size: 0.9rem; }
    
    /* Quote */
    .quote-card {
      margin: 1.5rem 1.25rem;
      padding: 1.25rem;
      background: linear-gradient(135deg, #1f2937, #111827);
      border-radius: 1rem;
      color: white;
    }
    
    .quote-card p { font-size: 0.9rem; opacity: 0.9; font-style: italic; line-height: 1.6; }
    .quote-card .author { font-size: 0.75rem; opacity: 0.6; margin-top: 0.5rem; font-style: normal; }
    
    /* Interventions View */
    .need-card {
      margin: 1.25rem;
      padding: 1rem;
      border-radius: 1rem;
      border: 1px solid;
    }
    
    .need-card .label { font-size: 0.875rem; font-weight: 500; color: #6b7280; margin-bottom: 0.25rem; }
    .need-card .text { font-weight: 500; }
    
    .interventions-list {
      padding: 0 1.25rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .intervention-card {
      background: white;
      border-radius: 0.75rem;
      border: 1px solid #e5e7eb;
      overflow: hidden;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    
    .intervention-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem;
      cursor: pointer;
    }
    
    .intervention-number {
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.875rem;
      font-weight: 500;
      flex-shrink: 0;
    }
    
    .intervention-title { font-weight: 500; flex: 1; }
    
    .intervention-detail {
      padding: 0 1rem 1rem 3.75rem;
      font-size: 0.875rem;
      color: #6b7280;
      line-height: 1.6;
      display: none;
    }
    
    .intervention-card.expanded .intervention-detail { display: block; }
    
    /* Chevron styling */
    .chevron {
      width: 1.25rem;
      height: 1.25rem;
      color: #9ca3af;
      transition: transform 0.2s;
      flex-shrink: 0;
    }
    
    .intervention-card.expanded .chevron { transform: rotate(180deg); }
    .content-item.expanded .chevron { transform: rotate(180deg); }
    
    .check-again-btn {
      margin: 1.5rem 1.25rem;
      width: calc(100% - 2.5rem);
      padding: 0.875rem;
      background: #f3f4f6;
      border: none;
      border-radius: 0.75rem;
      font-weight: 500;
      color: #374151;
      cursor: pointer;
      font-size: 1rem;
    }
    
    .check-again-btn:active { background: #e5e7eb; }
    
    /* Section View */
    .section-content {
      padding: 1.25rem;
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }
    
    .content-group {
      background: white;
      border-radius: 0.75rem;
      border: 1px solid #e5e7eb;
      overflow: hidden;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    
    .content-group-title {
      font-weight: 600;
      padding: 1rem;
      background: #f9fafb;
      border-bottom: 1px solid #e5e7eb;
      font-size: 0.95rem;
    }
    
    .content-item {
      border-bottom: 1px solid #f3f4f6;
      cursor: pointer;
    }
    
    .content-item:last-child { border-bottom: none; }
    
    .content-item-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.875rem 1rem;
      gap: 0.75rem;
    }
    
    .content-item-heading { font-weight: 500; font-size: 0.9rem; flex: 1; }
    
    .content-item-text {
      padding: 0 1rem 0.875rem;
      font-size: 0.875rem;
      color: #6b7280;
      line-height: 1.6;
      display: none;
    }
    
    .content-item.expanded .content-item-text { display: block; }
    
    /* Info/Prose sections */
    .prose-section {
      padding: 1.25rem;
    }
    
    .prose-card {
      background: white;
      border-radius: 0.75rem;
      border: 1px solid #e5e7eb;
      padding: 1.25rem;
      margin-bottom: 1rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    
    .prose-card:last-child { margin-bottom: 0; }
    
    .prose-card h3 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      color: #1f2937;
    }
    
    .prose-card p {
      font-size: 0.9rem;
      color: #4b5563;
      line-height: 1.7;
      margin-bottom: 0.75rem;
    }
    
    .prose-card p:last-child { margin-bottom: 0; }
    
    .prose-card strong { color: #1f2937; }
    
    .prose-card ul {
      margin: 0.5rem 0;
      padding-left: 1.25rem;
    }
    
    .prose-card li {
      font-size: 0.9rem;
      color: #4b5563;
      line-height: 1.6;
      margin-bottom: 0.375rem;
    }
    
    .highlight-box {
      background: #fef3c7;
      border: 1px solid #fcd34d;
      border-radius: 0.5rem;
      padding: 1rem;
      margin: 0.75rem 0;
    }
    
    .highlight-box p {
      color: #92400e;
      font-size: 0.875rem;
      margin: 0;
    }
    
    /* Safe area */
    @supports (padding-top: env(safe-area-inset-top)) {
      .header { padding-top: env(safe-area-inset-top); }
      body { padding-bottom: env(safe-area-inset-bottom); }
    }
  </style>
</head>
<body>
  <div class="container" id="app"></div>

  <script>
    const icons = {
      arrowLeft: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>',
      chevronDown: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>',
      brain: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></svg>',
      zap: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>',
      cloudOff: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 2l20 20M5 5a7 7 0 0 0 2.8 11.2M8.8 8.8a4 4 0 0 0 .9 7.2h6.6M19.1 19.1A7 7 0 0 0 18 5a5 5 0 0 0-9-1"/></svg>',
      check: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>',
      clock: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>',
      heart: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>',
      users: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/></svg>',
      briefcase: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="20" height="14" x="2" y="7" rx="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>',
      sun: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg>',
      info: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>',
      activity: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>'
    };

    const states = {
      understimulated: {
        id: 'understimulated',
        label: 'Understimulated',
        description: "Bored, restless, seeking, can't settle",
        icon: 'cloudOff',
        need: 'Stimulation — movement, novelty, engagement',
        interventions: [
          { title: 'Add stimulation', detail: 'Music, background noise, coffee shop sounds. Your brain needs MORE input to focus, not less.' },
          { title: 'Shrink the task', detail: 'Not "do the thing" — "open the document and write one sentence." Make starting trivial.' },
          { title: 'Body double', detail: 'Work alongside someone, even virtually. Borrow structure from outside yourself.' },
          { title: 'Change environment', detail: 'Different room, different chair, go outside. Novelty activates attention.' },
          { title: 'Movement first', detail: '5 minutes of physical activity. Walk, stretch, shake. Then try again.' }
        ]
      },
      overwhelmed: {
        id: 'overwhelmed',
        label: 'Overwhelmed',
        description: "Paralysed, shutdown, foggy, can't start",
        icon: 'brain',
        need: 'Discharge — physical release, then containment',
        interventions: [
          { title: 'Physical discharge first', detail: "Cold water on face, intense movement, shake it out. Your body needs to release before your mind can work." },
          { title: 'Reduce inputs', detail: "Close tabs, silence notifications, find quiet. You're overloaded — remove stimulation." },
          { title: 'One thing only', detail: "What's the ONE thing with actual consequences? Do only that. Everything else waits." },
          { title: 'Lower the bar', detail: '"Good enough" is the goal. Excellence is not available right now, and that\'s fine.' },
          { title: 'Tell someone', detail: 'Isolation amplifies the spiral. One text to one person: "I\'m struggling today."' }
        ]
      },
      hyperactivated: {
        id: 'hyperactivated',
        label: 'Hyperactivated',
        description: "Racing, anxious, can't stop, mind spinning",
        icon: 'zap',
        need: 'Grounding — slow breath, body awareness, boundaries',
        interventions: [
          { title: 'Extended exhale breathing', detail: 'Breathe in for 4, out for 8. The long exhale activates your parasympathetic system.' },
          { title: 'Physical grounding', detail: 'Feet on floor. Name 5 things you can see. Feel your hands. Come back to your body.' },
          { title: 'Time anchor', detail: 'Say out loud: "It\'s [time]. I have [X hours] until [next thing]." Time becomes real when spoken.' },
          { title: 'Reality check', detail: "Ask: \"What's actually urgent right now?\" Usually nothing. The urgency is internal, not real." },
          { title: 'Boundaries', detail: "You're allowed to stop. You're allowed to say no. You're allowed to do less." }
        ]
      },
      regulated: {
        id: 'regulated',
        label: 'Regulated',
        description: 'Present, capable, engaged but not frantic',
        icon: 'check',
        need: "Maintenance — don't blow it with overcommitment",
        interventions: [
          { title: 'Use this window wisely', detail: 'This is your deep work time. Complex decisions, creative work, hard conversations — do them now.' },
          { title: "Don't overcommit", detail: "Feeling capable ≠ being capable of everything. Protect this state by not overloading it." },
          { title: 'Note what got you here', detail: 'What did you do today that helped? Sleep, movement, food, environment? Remember it.' },
          { title: 'Batch the hard stuff', detail: 'Admin, emails, difficult tasks — knock them out while you have capacity.' },
          { title: 'Schedule rest', detail: "You'll crash eventually. Plan for it rather than being surprised by it." }
        ]
      }
    };

    const sections = {
      tasks: {
        id: 'tasks', label: 'Tasks', icon: 'clock',
        content: [
          { title: 'Starting (The Hardest Part)', items: [
            { heading: 'Shrink the commitment', text: 'Not "write the report" — "open the document and write one sentence." Your brain rebels against large commitments. Make starting trivial.' },
            { heading: 'Implementation intentions', text: '"When I finish lunch, I will immediately open the spreadsheet." Linking new behaviour to existing triggers bypasses decision fatigue.' },
            { heading: 'Externalise motivation', text: 'Accountability partners, public commitments, coworking. Internal motivation is unreliable; borrow structure from outside.' }
          ]},
          { title: 'Sustaining Focus', items: [
            { heading: 'Timeboxing', text: 'Work in defined blocks: 25 or 45 minutes. Open-ended sessions are focus death. Containers create urgency.' },
            { heading: 'The "boring" workaround', text: "Can you make it novel? Gamify it? Add stakes? You're not lazy — you're understimulated." },
            { heading: 'One tab, one task', text: "Close everything except what you're working on. Every open option is a leak in your attention." }
          ]},
          { title: 'Finishing', items: [
            { heading: 'Define "done" before starting', text: 'Not "work on presentation" — "complete slides 1-5 with speaker notes." Ambiguous endpoints make completion impossible.' },
            { heading: 'Completion rituals', text: 'Physical act to mark finishing: close the laptop, stand up, say "done" out loud. Your brain needs clear signals.' },
            { heading: 'The 90% trap', text: 'ADD brains often stop at "basically done." Build in a final review step. The last 10% is where things fall apart.' }
          ]}
        ]
      },
      emotions: {
        id: 'emotions', label: 'Emotions', icon: 'heart',
        content: [
          { title: 'The ADD Emotional Pattern', items: [
            { heading: 'Fast and intense', text: "Feelings arrive quickly and hit hard. This isn't weakness — it's part of the same dysregulation that affects attention." },
            { heading: 'Rejection sensitivity', text: "Criticism lands disproportionately. You're not overreacting — your nervous system processes it differently." },
            { heading: 'Rumination loops', text: 'Difficulty letting things go. The same thought circling. This is attention dysregulation applied to emotions.' }
          ]},
          { title: 'Working With It', items: [
            { heading: "The feeling isn't the problem", text: 'The avoidance is. Most ADD coping (distraction, busyness) is avoiding feelings. The scatteredness often IS the avoidance.' },
            { heading: 'Tolerate before you regulate', text: 'When a difficult feeling arises, pause. Don\'t fix or distract. Just notice: "I feel anxious." Stay with it for 30 seconds.' },
            { heading: 'Separate feeling from story', text: '"I feel rejected" is a feeling. "They think I\'m incompetent" is a story. You can have the feeling without believing the story.' }
          ]},
          { title: 'On Shame', items: [
            { heading: "It's not earned", text: 'The shame of "I should be able to do this" is inherited, not deserved. You adapted to circumstances.' },
            { heading: 'Address it directly', text: 'Unexamined shame runs your life. Name it. Look at it. Ask: where did this come from?' }
          ]}
        ]
      },
      relationships: {
        id: 'relationships', label: 'Relationships', icon: 'users',
        content: [
          { title: 'Common Patterns', items: [
            { heading: 'Interrupting', text: 'Impulse control failure. Try: physical anchor — hold an object, press fingers together when the urge arises.' },
            { heading: 'Forgetting commitments', text: 'Time blindness + out of sight = out of mind. Use shared calendars, immediate capture, repeat back what was agreed.' },
            { heading: 'Emotional reactivity', text: 'Feels like overreaction to others. Try: "Let me think about that and come back to you." Build in time delays.' },
            { heading: 'Inconsistent presence', text: 'Hyperfocus elsewhere. Schedule protected time for relationships. Devices physically away.' }
          ]},
          { title: 'How to Explain It', items: [
            { heading: 'A script that works', text: '"My brain works differently in ways that affect [specific behaviour]. It\'s not that I don\'t care. Here\'s what I\'m doing to manage it: [strategy]. Here\'s what would help from you: [request]."' },
            { heading: "Don't over-apologise", text: "Don't use ADD as an excuse. Do be specific and solutions-oriented. Take responsibility without taking blame." }
          ]}
        ]
      },
      work: {
        id: 'work', label: 'Work', icon: 'briefcase',
        content: [
          { title: 'Meeting Your Limitations', items: [
            { heading: 'Time estimation is broken', text: 'Build in buffers. Never promise tight turnarounds. Add 50% to every estimate as default.' },
            { heading: 'Sustained admin is impossible', text: "Batch it, outsource it, or automate it. Don't pretend you'll do it consistently." },
            { heading: 'Open-plan destroys you', text: 'Noise-cancelling headphones, remote work when possible, find private space.' },
            { heading: 'Email becomes a graveyard', text: 'Time-blocked processing (twice daily), not reactive checking.' }
          ]},
          { title: 'Playing to Strengths', items: [
            { heading: 'Crisis response', text: "High stimulation = engagement. You're good in emergencies." },
            { heading: 'Novel problem-solving', text: 'You see connections others miss. Non-linear thinking is an asset.' },
            { heading: 'Hyperfocus bursts', text: 'When aligned with interest, you can outwork anyone. Unsustainable but powerful.' },
            { heading: 'Stop trying to be consistent', text: "You're not going to become a steady plodder. Design your role around what you're actually good at." }
          ]},
          { title: 'Energy Management', items: [
            { heading: 'Your capacity is variable', text: "Not constant. Track when you're sharp, when you crash. Build your schedule around this." },
            { heading: 'High-energy windows', text: 'Deep work, complex decisions, creative work. Protect these times aggressively.' },
            { heading: 'Low-energy windows', text: "Admin, email, routine tasks. Don't waste good hours on these." }
          ]}
        ]
      },
      routines: {
        id: 'routines', label: 'Routines', icon: 'sun',
        content: [
          { title: 'Morning Non-Negotiables', items: [
            { heading: 'No phone first 30-60 mins', text: "Protect your attentional state before it's hijacked. This is the highest-leverage habit." },
            { heading: 'Physical activation', text: 'Movement wakes up the prefrontal cortex. Even 10 minutes.' },
            { heading: 'Review the day', text: 'What are the 1-3 things that actually matter today? Not a list. Priorities.' },
            { heading: 'Eat protein', text: 'Stabilises blood sugar, supports dopamine production. Not optional.' }
          ]},
          { title: 'Evening Wind-Down', items: [
            { heading: 'Hard stop on work', text: 'Defined time, not "when I\'m done." You\'ll never feel done.' },
            { heading: 'Brain dump', text: 'Write down anything still spinning. Get it out of your head and onto paper.' },
            { heading: 'Reduce stimulation', text: 'Screens down, lights low. Your nervous system needs the signal.' },
            { heading: 'Same sleep time', text: 'Irregular sleep worsens everything. Protect this ruthlessly.' }
          ]},
          { title: 'Weekly Rhythm', items: [
            { heading: 'Weekly review', text: "What worked? What didn't? Adjust systems. 30 minutes, same time each week." },
            { heading: 'Plan the week', text: 'Not a detailed schedule. Key priorities identified. Buffer space left.' },
            { heading: 'One "off" period', text: 'Time with no obligations, no productivity pressure. This is not optional.' }
          ]}
        ]
      }
    };

    let currentView = 'home';
    let selectedState = null;
    let selectedSection = null;

    function render() {
      const app = document.getElementById('app');
      if (currentView === 'home') app.innerHTML = renderHome();
      else if (currentView === 'checkin') app.innerHTML = renderCheckin();
      else if (currentView === 'interventions') app.innerHTML = renderInterventions();
      else if (currentView === 'section') app.innerHTML = renderSection();
      else if (currentView === 'understand') app.innerHTML = renderUnderstand();
      attachEventListeners();
      window.scrollTo(0, 0);
    }

    function renderHome() {
      return `
        <div class="home-header">
          <h1>ADD Companion</h1>
          <p>Based on Gabor Maté's Scattered Minds</p>
        </div>
        <div class="main-options">
          <div class="option-card option-checkin" data-action="checkin">
            <div class="option-card-header">
              <div class="option-icon">${icons.activity}</div>
              <span class="option-label">I need help now</span>
            </div>
            <p class="option-desc">Check in with how you're feeling and get practical support</p>
          </div>
          <div class="option-card option-understand" data-action="understand">
            <div class="option-card-header">
              <div class="option-icon">${icons.info}</div>
              <span class="option-label">Understanding ADD</span>
            </div>
            <p class="option-desc">What it is, where it comes from, and why this approach works</p>
          </div>
        </div>
        <h2 class="sections-header">Go deeper</h2>
        <div class="sections-grid">
          ${Object.values(sections).map(s => `
            <button class="section-btn" data-section="${s.id}">
              ${icons[s.icon]}
              <span>${s.label}</span>
            </button>
          `).join('')}
        </div>
        <div class="quote-card">
          <p>"The greatest gift you can give yourself is to understand yourself without judgment."</p>
          <p class="author">— Gabor Maté</p>
        </div>
      `;
    }

    function renderCheckin() {
      return `
        <div class="header">
          <div class="header-inner">
            <button class="back-btn" data-action="home">${icons.arrowLeft}</button>
            <h1 class="header-title">How are you right now?</h1>
          </div>
        </div>
        <div class="states-grid" style="padding-top: 1.25rem;">
          ${Object.values(states).map(state => `
            <div class="state-${state.id}" data-state="${state.id}">
              <div class="state-card">
                <div class="state-card-header">
                  <div class="state-icon">${icons[state.icon]}</div>
                  <span class="state-label">${state.label}</span>
                </div>
                <p class="state-desc">${state.description}</p>
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    function renderInterventions() {
      const state = states[selectedState];
      const colors = {
        understimulated: { bg: '#fffbeb', border: '#fde68a', text: '#b45309', accent: '#f59e0b' },
        overwhelmed: { bg: '#f8fafc', border: '#cbd5e1', text: '#475569', accent: '#64748b' },
        hyperactivated: { bg: '#fff1f2', border: '#fecdd3', text: '#be123c', accent: '#f43f5e' },
        regulated: { bg: '#ecfdf5', border: '#a7f3d0', text: '#047857', accent: '#10b981' }
      }[selectedState];
      
      return `
        <div class="header">
          <div class="header-inner">
            <button class="back-btn" data-action="checkin">${icons.arrowLeft}</button>
            <h1 class="header-title">${state.label}</h1>
          </div>
        </div>
        <div class="need-card" style="background:${colors.bg};border-color:${colors.border};">
          <p class="label">What you need:</p>
          <p class="text" style="color:${colors.text};">${state.need}</p>
        </div>
        <div class="interventions-list">
          ${state.interventions.map((int, i) => `
            <div class="intervention-card ${i===0?'expanded':''}" data-intervention="${i}">
              <div class="intervention-header">
                <div class="intervention-number" style="background:${colors.accent};">${i+1}</div>
                <span class="intervention-title">${int.title}</span>
                <span class="chevron">${icons.chevronDown}</span>
              </div>
              <div class="intervention-detail">${int.detail}</div>
            </div>
          `).join('')}
        </div>
        <button class="check-again-btn" data-action="checkin">Check in again</button>
      `;
    }

    function renderSection() {
      const section = sections[selectedSection];
      return `
        <div class="header">
          <div class="header-inner">
            <button class="back-btn" data-action="home">${icons.arrowLeft}</button>
            <h1 class="header-title">${section.label}</h1>
          </div>
        </div>
        <div class="section-content">
          ${section.content.map(group => `
            <div class="content-group">
              <h3 class="content-group-title">${group.title}</h3>
              ${group.items.map((item, i) => `
                <div class="content-item" data-item="${i}">
                  <div class="content-item-header">
                    <span class="content-item-heading">${item.heading}</span>
                    <span class="chevron">${icons.chevronDown}</span>
                  </div>
                  <div class="content-item-text">${item.text}</div>
                </div>
              `).join('')}
            </div>
          `).join('')}
        </div>
      `;
    }

    function renderUnderstand() {
      return `
        <div class="header">
          <div class="header-inner">
            <button class="back-btn" data-action="home">${icons.arrowLeft}</button>
            <h1 class="header-title">Understanding ADD</h1>
          </div>
        </div>
        <div class="prose-section">
          <div class="prose-card">
            <h3>What ADD Actually Is</h3>
            <p>ADD is <strong>not</strong> a character flaw, laziness, or lack of intelligence. It's a <strong>developmental adaptation</strong> — your brain organised itself around early environmental conditions (stress, attunement gaps, chaos) in ways that made sense at the time.</p>
            <p>The core issue isn't attention. It's <strong>self-regulation</strong>. Your nervous system struggles to:</p>
            <ul>
              <li>Maintain optimal arousal (you're either understimulated or overwhelmed)</li>
              <li>Filter stimuli (everything feels equally urgent)</li>
              <li>Tolerate uncomfortable internal states (boredom, anxiety, emptiness)</li>
            </ul>
            <div class="highlight-box">
              <p><strong>Why this matters:</strong> If you think ADD is a willpower problem, you'll try to force yourself through it and fail. If you understand it as a regulation problem, you can design around it.</p>
            </div>
          </div>

          <div class="prose-card">
            <h3>Where It Comes From</h3>
            <p>Maté's view: ADD develops in the context of early relationships. It's not purely genetic — it emerges when a child's environment doesn't provide the consistent, attuned presence needed for the brain to develop robust self-regulation.</p>
            <p>This isn't about blame. Parents were doing their best with their own circumstances. But understanding the origin helps you see that <strong>you adapted to survive</strong>, and those adaptations are still running.</p>
          </div>

          <div class="prose-card">
            <h3>The Four Core Struggles</h3>
            <p><strong>1. Attention Dysregulation</strong><br>
            Not a deficit — a dysregulation. You can hyperfocus for hours on the right thing; you can't direct attention voluntarily to the "wrong" thing. Your reward system needs higher stimulation to engage.</p>
            <p><strong>2. Impulse Control</strong><br>
            The gap between stimulus and response is too short. You act before the executive brain has time to weigh in. The prefrontal cortex is underactive relative to the limbic system.</p>
            <p><strong>3. Restlessness</strong><br>
            Physical (can't sit still) or mental (racing thoughts). Your nervous system is seeking stimulation to reach baseline. Stillness feels like deprivation.</p>
            <p><strong>4. Emotional Sensitivity</strong><br>
            Often overlooked. Intense emotional responses, rejection sensitivity, difficulty letting things go. The same dysregulation that affects attention affects emotional processing.</p>
          </div>

          <div class="prose-card">
            <h3>What ADD Is Good For</h3>
            <p>Your brain isn't broken — it's different. ADD often comes with genuine strengths:</p>
            <ul>
              <li><strong>Crisis response:</strong> High stimulation = engagement. You're good when things are urgent.</li>
              <li><strong>Novel problem-solving:</strong> You see connections others miss. Non-linear thinking is an asset.</li>
              <li><strong>Hyperfocus:</strong> When aligned with interest, you can outwork anyone.</li>
              <li><strong>Energy and enthusiasm:</strong> When you're engaged, you bring intensity others can't match.</li>
            </ul>
            <p>The goal isn't to eliminate these traits — it's to <strong>channel them</strong> and manage the downsides.</p>
          </div>

          <div class="prose-card">
            <h3>What About Medication?</h3>
            <p>Medication can help. It adjusts dopamine and norepinephrine levels, making it easier to engage with low-stimulation tasks and improving impulse control.</p>
            <p><strong>What medication does:</strong></p>
            <ul>
              <li>Raises baseline arousal so you need less external stimulation</li>
              <li>Improves working memory and focus</li>
              <li>Reduces impulsivity</li>
            </ul>
            <p><strong>What medication doesn't do:</strong></p>
            <ul>
              <li>Teach you skills you never developed</li>
              <li>Change ingrained habits and coping mechanisms</li>
              <li>Address the emotional patterns (shame, avoidance, sensitivity)</li>
              <li>Design your environment and systems for you</li>
            </ul>
            <div class="highlight-box">
              <p>Medication can make it <em>easier</em> to do the work — but the work still has to be done. That's what this approach is about.</p>
            </div>
          </div>

          <div class="prose-card">
            <h3>Why This Approach</h3>
            <p>This isn't about forcing yourself to be "normal." It's about understanding your nervous system and working <strong>with</strong> it rather than against it.</p>
            <p>The framework here is practical:</p>
            <ul>
              <li><strong>Recognise your state</strong> — know whether you're understimulated, overwhelmed, or hyperactivated</li>
              <li><strong>Intervene appropriately</strong> — different states need different responses</li>
              <li><strong>Design your environment</strong> — stop relying on willpower; build systems</li>
              <li><strong>Address the emotional layer</strong> — the shame, the avoidance, the sensitivity</li>
            </ul>
            <p>The goal isn't to become neurotypical. The goal is to become <strong>functional, fulfilled, and at peace with who you actually are.</strong></p>
          </div>
        </div>
      `;
    }

    function attachEventListeners() {
      document.querySelectorAll('[data-action="checkin"]').forEach(el => {
        el.addEventListener('click', () => { currentView = 'checkin'; render(); });
      });
      document.querySelectorAll('[data-action="understand"]').forEach(el => {
        el.addEventListener('click', () => { currentView = 'understand'; render(); });
      });
      document.querySelectorAll('[data-action="home"]').forEach(el => {
        el.addEventListener('click', () => { currentView = 'home'; selectedState = null; selectedSection = null; render(); });
      });
      document.querySelectorAll('[data-state]').forEach(el => {
        el.addEventListener('click', () => { selectedState = el.dataset.state; currentView = 'interventions'; render(); });
      });
      document.querySelectorAll('[data-section]').forEach(el => {
        el.addEventListener('click', () => { selectedSection = el.dataset.section; currentView = 'section'; render(); });
      });
      document.querySelectorAll('[data-intervention]').forEach(el => {
        el.querySelector('.intervention-header').addEventListener('click', () => { el.classList.toggle('expanded'); });
      });
      document.querySelectorAll('.content-item').forEach(el => {
        el.addEventListener('click', () => { el.classList.toggle('expanded'); });
      });
    }

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('data:text/javascript,' + encodeURIComponent(`
        self.addEventListener('install', e => self.skipWaiting());
        self.addEventListener('activate', e => e.waitUntil(clients.claim()));
      `)).catch(() => {});
    }

    render();
  </script>
</body>
</html>
